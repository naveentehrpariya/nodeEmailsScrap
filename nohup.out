(node:55364) [MONGOOSE] DeprecationWarning: Mongoose: the `strictQuery` option will be switched back to `false` by default in Mongoose 7. Use `mongoose.set('strictQuery', false);` if you want to prepare for this change. Or use `mongoose.set('strictQuery', true);` to suppress this warning.
(Use `node --trace-deprecation ...` to show where the warning was created)
🚀 Media proxy server running on port 5001
📡 Health check: http://localhost:5001/health
🖼️  Media endpoint: http://localhost:5001/api/media/:chatId/:messageIndex/:attachmentIndex
✓ Connected to MongoDB
📥 Media request: Chat 68a228c16d2253e44223db64, Message 1, Attachment 0
Found attachment: Image_20250816_004022_952.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Downloaded 1118044 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
📥 Media request: Chat 68a228c16d2253e44223db64, Message 0, Attachment 0
📥 Media request: Chat 68a23187eae12a849a664b02, Message 1, Attachment 0
📥 Media request: Chat 68a23187eae12a849a664b02, Message 1, Attachment 1
Found attachment: Image_20250816_004022_952.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250816_004022_952.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Downloaded 1118241 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Downloaded 1118504 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Downloaded 1120108 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
Downloaded 1118131 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Downloaded 1120093 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
Downloaded 1118420 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Downloaded 1120241 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
Downloaded 1118116 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Downloaded 1120185 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
Downloaded 1119539 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 200
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Downloaded 1118302 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Response status: 200
Downloaded 1120156 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Downloaded 1121734 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
Downloaded 1118280 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Downloaded 1118244 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Downloaded 1120328 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
📥 Media request: Chat 68a23187eae12a849a664b02, Message 1, Attachment 0
📥 Media request: Chat 68a23187eae12a849a664b02, Message 1, Attachment 1
Found attachment: Image_20250816_004022_952.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250816_004022_952.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Downloaded 1121363 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
Downloaded 1118516 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Downloaded 1118922 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Downloaded 1118428 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Downloaded 1120888 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
Downloaded 1118171 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 7, Attachment 0
📥 Media request: Chat 68a231f6f30ddf1036699e2e, Message 11, Attachment 0
Found attachment: Screenshot 2025-07-24 at 10.08.17 PM.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250812_221313_040.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
📥 Media request: Chat 68a23187eae12a849a664b02, Message 1, Attachment 0
📥 Media request: Chat 68a23187eae12a849a664b02, Message 1, Attachment 1
Found attachment: Image_20250816_004022_952.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250816_004022_952.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 200
Response status: 200
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Downloaded 1120796 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Media proxy error: TypeError [ERR_INVALID_CHAR]: Invalid character in header content ["Content-Disposition"]
    at ServerResponse.setHeader (node:_http_outgoing:645:3)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:794:10)
    at ServerResponse.header (/Users/naveentehrpariya/Work/EmailScrap/backend/node_modules/express/lib/response.js:797:12)
    at /Users/naveentehrpariya/Work/EmailScrap/backend/media_proxy_server.js:203:17
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ERR_INVALID_CHAR'
}
Downloaded 1118393 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Response status: 200
Response status: 200
Downloaded 1118342 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Downloaded 1118617 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
📥 Media request: Chat 68a23187eae12a849a664b02, Message 1, Attachment 0
📥 Media request: Chat 68a23187eae12a849a664b02, Message 1, Attachment 1
Found attachment: Image_20250816_004022_952.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Found attachment: Image_20250816_004022_952.png
🌐 Attempting to download from Google Chat...
Trying downloadUrl...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/ServiceLogin?service=dynamite&passive=1209600&osid=1&continue=https://ch...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/InteractiveLogin?continue=https://chat.google.com/api/get_attachment_url...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 302
Following redirect to: https://accounts.google.com/v3/signin/identifier?continue=https%3A%2F%2Fchat.google.com%2Fapi%2Fget_...
Response status: 200
Response status: 200
Downloaded 1118291 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
Downloaded 1118683 bytes
✅ Success with downloadUrl
✅ Downloaded from Google Chat
